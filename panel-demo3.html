<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>仪表盘-3</title>
<style>
    * {
        margin: 0;
        padding: 0;
    }
	div#echarts {
		background-color: #0f0f0f;
	}

    .echarts {
        width: 400px;
        height: 400px;
    }
	.pan {
		width: 1427px;
		height: 1246px;
		background: url(img/gear-bg.png);
		position: relative;
	}
	.gear {
		width: 539px;
		height: 513px;
		position: absolute;
		top: 400px;
		left: 454px;
	}
</style>
<script src="js/echarts.js"></script>
</head>

<body>
    <p>参考地址：<a href="https://www.makeapie.com/editor.html?c=xFkzKG-bpl">https://www.makeapie.com/editor.html?c=xFkzKG-bpl</a></p>
	<br>
	<div id="echarts" class="echarts"></div>
	
	<div class="pan">
		<div class="gear"><img src="./img/gear.gif" alt=""></div>
	</div>
	
</body>

<script>
var chart, option, data, timeTickId, max;
var data = {
	c0:'仪表名字', // 表盘名称
	c1:'100', // 计划值
	c2:'75', // 完成值
}
window.onload = function init() {
    myChart = echarts.init(document.getElementById("echarts")); //初始化chart容器
}

let angle = 0;//角度，用来做简单的动画效果的
let value = 60;
option = {
// backgroundColor:"#061740",
// backgroundColor:"transparent",
	title: {
        text: '{a|'+ value +'}{c|%}',
        x: 'center',
        y: 'center',
        textStyle: {
            rich:{
                a: {
                    fontSize: 58,
                    color: '#29EEF3'
                },
                
                c: {
                    fontSize: 58,
                    color: '#29EEF3',
                    // padding: [5,0]
                }
            }
        }
    },
    // legend: {
    //     type: "plain",
    //     orient: "vertical",
    //     right: 0,
    //     top: "10%",
    //     align: "auto",
    //     data: [{
    //         name: '涨价后没吃过',
    //         icon: "circle"
    //     }, {
    //         name: '天天吃',
    //         icon: "circle"
    //     }, {
    //         name: '三五天吃一次',
    //         icon: "circle"
    //     }, {
    //         name: '半个月吃一次',
    //         icon: "circle"
    //     }],
    //     textStyle: {
    //         color: "white",
    //         fontSize: 16,
    //         padding: [10, 1, 10, 0]
    //     },
    //     selectedMode:false
    // },
    series: [ {
            name: "ring5",
            type: 'custom',
            coordinateSystem: "none",
            renderItem: function(params, api) {
                return {
                    type: 'arc',
                    shape: {
                        cx: api.getWidth() / 2,
                        cy: api.getHeight() / 2,
                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.6,
                        startAngle: (0+angle) * Math.PI / 180,
                        endAngle: (90+angle) * Math.PI / 180
                    },
                    style: {
                        stroke: "#0CD3DB",
                        fill: "transparent",
                        lineWidth: 1.5
                    },
                    silent: true
                };
            },
            data: [0]
        }, {
            name: "ring5",
            type: 'custom',
            coordinateSystem: "none",
            renderItem: function(params, api) {
                return {
                    type: 'arc',
                    shape: {
                        cx: api.getWidth() / 2,
                        cy: api.getHeight() / 2,
                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.6,
                        startAngle: (180+angle) * Math.PI / 180,
                        endAngle: (270+angle) * Math.PI / 180
                    },
                    style: {
                        stroke: "#0CD3DB",
                        fill: "transparent",
                        lineWidth: 1.5
                    },
                    silent: true
                };
            },
            data: [0]
        }, {
            name: "ring5",
            type: 'custom',
            coordinateSystem: "none",
            renderItem: function(params, api) {
                return {
                    type: 'arc',
                    shape: {
                        cx: api.getWidth() / 2,
                        cy: api.getHeight() / 2,
                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.65,
                        startAngle: (270+-angle) * Math.PI / 180,
                        endAngle: (40+-angle) * Math.PI / 180
                    },
                    style: {
                        stroke: "#0CD3DB",
                        fill: "transparent",
                        lineWidth: 1.5
                    },
                    silent: true
                };
            },
            data: [0]
        }, {
            name: "ring5",
            type: 'custom',
            coordinateSystem: "none",
            renderItem: function(params, api) {
                return {
                    type: 'arc',
                    shape: {
                        cx: api.getWidth() / 2,
                        cy: api.getHeight() / 2,
                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.65,
                        startAngle: (90+-angle) * Math.PI / 180,
                        endAngle: (220+-angle) * Math.PI / 180
                    },
                    style: {
                        stroke: "#0CD3DB",
                        fill: "transparent",
                        lineWidth: 1.5
                    },
                    silent: true
                };
            },
            data: [0]
        }, 
		// { // new added 1
  //           name: "ring6",
  //           type: 'custom',
  //           coordinateSystem: "none",
  //           renderItem: function(params, api) {
  //               return {
  //                   type: 'arc',
  //                   shape: {
  //                       cx: api.getWidth() / 2,
  //                       cy: api.getHeight() / 2,
  //                       r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.47, // 线圈大小？？？？
  //                       startAngle: (0+-angle) * Math.PI / 180,
  //                       endAngle: (130+-angle) * Math.PI / 180
  //                   },
  //                   style: {
  //                       stroke: "red",
  //                       fill: "transparent",
  //                       lineWidth: 1.5,
  //                   },
  //                   silent: true
  //               };
  //           },
  //           data: [0]
  //       }, 
		{
            name: "ring5",
            type: 'custom',
            coordinateSystem: "none",
            renderItem: function(params, api) {
                let x0 = api.getWidth() / 2;
                let y0 = api.getHeight() / 2;
                let r = Math.min(api.getWidth(), api.getHeight()) / 2 * 0.65;
                let point = getCirlPoint(x0, y0, r, (90+-angle))
                return {
                    type: 'circle',
                    shape: {
                        cx: point.x,
                        cy: point.y,
                        r: 4
                    },
                    style: {
                        stroke: "#0CD3DB",//粉
                        fill: "#0CD3DB"
                    },
                    silent: true
                };
            },
            data: [0]
        }, {
            name: "ring5",  //绿点
            type: 'custom',
            coordinateSystem: "none",
            renderItem: function(params, api) {
                let x0 = api.getWidth() / 2;
                let y0 = api.getHeight() / 2;
                let r = Math.min(api.getWidth(), api.getHeight()) / 2 * 0.65;
                let point = getCirlPoint(x0, y0, r, (270+-angle))
                return {
                    type: 'circle',
                    shape: {
                        cx: point.x,
                        cy: point.y,
                        r: 4
                    },
                    style: {
                        stroke: "#0CD3DB",      //绿
                        fill: "#0CD3DB"
                    },
                    silent: true
                };
            },
            data: [0]
        }, 
		// { // new added 2 -----------
  //           name: "ring6",  //绿点
  //           type: 'custom',
  //           coordinateSystem: "none",
  //           renderItem: function(params, api) {
  //               let x0 = api.getWidth() / 2;
  //               let y0 = api.getHeight() / 2;
  //               let r = Math.min(api.getWidth(), api.getHeight()) / 2 * 0.47;  // 点位置？？？？
  //               let point = getCirlPoint(x0, y0, r, (0+-angle))
  //               return {
  //                   type: 'circle',
  //                   shape: {
  //                       cx: point.x,
  //                       cy: point.y,
  //                       r: 4
  //                   },
  //                   style: {
  //                       stroke: "red",      //红
  //                       fill: "red",
  //                   },
  //                   silent: true
  //               };
  //           },
  //           data: [0]
  //       }, 
		{
            name: '',
            type: 'pie',
            radius: ['55%', '53%'],
            silent: true,
            clockwise: true,
            startAngle: 90,
            z: 0,
            zlevel: 0,
            label: {
                normal: {
                    position: "center",
                }
            },
            data: [{
                    value: value,
                    name: "",
                    itemStyle: {
                        normal: {
                            color: { // 完成的圆环的颜色
                                colorStops: [{
                                    offset: 0,
                                    color: '#d0f62c' // 0% 处的颜色
                                }, {
                                    offset: 1,
                                    color: '#d0f62c' // 100% 处的颜色
                                }]
                            },
                        }
                    }
                },
                {
                    value: 100-value,
                    name: "",
                    label: {
                        normal: {
                            show: false
                        }
                    },
                    itemStyle: {
                        normal: {
                            color: "#0a73b4" // 背景色
                        }
                    }
                }
            ]
        },
        
        {
            name: "",
            type: "gauge",
            radius: "55%",
            center: ['50%', '50%'],
            startAngle: 0,
            endAngle: 359.9,
            splitNumber: 70,
            hoverAnimation: true,
            axisTick: {
                show: false
            },
            splitLine: {
                length: 4, // 分割线长度
                lineStyle: {
                    width: 2,
                    color: "#10345a"  // 分割线颜色 #d0f62c
                }
            },
            axisLabel: {
                show: false
            },
            pointer: {
                show: false
            },
            axisLine: {
                lineStyle: {
                    opacity: 0
                }
            },
            detail: {
                show: false
            },
            data: [{
                value: 0,
                name: ""
            }]
        },
        
    ]
};

//获取圆上面某点的坐标(x0,y0表示坐标，r半径，angle角度)
function getCirlPoint(x0, y0, r, angle) {
    let x1 = x0 + r * Math.cos(angle * Math.PI / 180)
    let y1 = y0 + r * Math.sin(angle * Math.PI / 180)
    return {
        x: x1,
        y: y1
    }
}

function draw(){
    angle = angle+3
    myChart.setOption(option, true)
   //window.requestAnimationFrame(draw);
}

setInterval(function() {
    //用setInterval做动画感觉有问题
    draw()
}, 100);

</script>
</html>